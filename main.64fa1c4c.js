parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"BL8S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={blank:0,wall:1,floor:2,door:3,stairsUp:4,stairsDown:5};exports.default=e;
},{}],"U5Xy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./tiles"));function t(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}var o=function(){function t(s,i){r(this,t),this.size={x:s,y:i},this.pos={x:0,y:0},this.tiles=[];for(var o=0;o<this.size.y;o++){for(var n=[],a=0;a<this.size.x;a++)0===o||o===this.size.y-1||0===a||a===this.size.x-1?n.push(e.default.wall):n.push(e.default.floor);this.tiles.push(n)}}return i(t,[{key:"hasStairs",value:function(){for(var t=0;t<this.size.y;t++)for(var r=0;r<this.size.x;r++)if(this.tiles[t][r]===e.default.stairsDown||this.tiles[t][r]===e.default.stairsUp)return!0;return!1}},{key:"getDoorLocations",value:function(){for(var t=[],r=0;r<this.size.y;r++)for(var s=0;s<this.size.x;s++)this.tiles[r][s]===e.default.door&&t.push({x:s,y:r});return t}}],[{key:"areConnected",value:function(t,r){for(var s=t.getDoorLocations(),i=0;i<s.length;i++){var o=s[i];if(o.x+=t.pos.x,o.y+=t.pos.y,o.x-=r.pos.x,o.y-=r.pos.y,!(o.x<0||o.x>r.size.x-1||o.y<0||o.y>r.size.y-1)&&r.tiles[o.y][o.x]===e.default.door)return!0}return!1}}]),t}();exports.default=o;
},{"./tiles":"BL8S"}],"F6Jf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o=e(require("./room")),s=e(require("./tiles"));function e(o){return o&&o.__esModule?o:{default:o}}function i(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}function t(o,s){for(var e=0;e<s.length;e++){var i=s[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function r(o,s,e){return s&&t(o.prototype,s),e&&t(o,e),o}var a=Math.floor,n=Math.random,y=Math.min,h=Math.max,u=function(o,s){return a(n()*(s-o)+o)},x=function(o){return o[a(n()*o.length)]},p=function(){function e(o,s){i(this,e),this.size={x:o,y:s},this.minRoomSize=5,this.maxRoomSize=15,this.maxNumRooms=50,this.maxRoomArea=150,this.addStairsUp=!0,this.addStairsDown=!0,this.rooms=[],this.roomGrid=[]}return r(e,[{key:"getStairs",value:function(){for(var o={up:null,down:null},e=0;e<this.rooms.length;e++){var i=this.rooms[e];if(i.hasStairs())for(var t=0;t<i.size.y;t++)for(var r=0;r<i.size.x;r++)i.tiles[t][r]===s.default.stairsUp?o.up={x:i.pos.x+r,y:i.pos.y+t}:i.tiles[t][r]===s.default.stairsUp&&(o.down={x:i.pos.x+r,y:i.pos.y+t})}return o}},{key:"generate",value:function(){this.rooms=[],this.roomGrid=Array(this.size.y);for(var e=0;e<this.size.y;e++){for(var i=Array(this.size.x),t=0;t<this.size.x;t++)i[t]=[];this.roomGrid[e]=i}var r=this.createRandomRoom();r.pos={x:a(this.size.x/2)-a(r.size.x/2),y:a(this.size.y/2)-a(r.size.y/2)},this.addRoom(r);for(var y=5*this.maxNumRooms;(this.maxNumRooms<=0||this.rooms.length<this.maxNumRooms)&&y-- >0;)this.generateRoom();for(var h=0;h<this.rooms.length;h++)for(var u=this.getPotentiallyTouchingRooms(this.rooms[h]),x=0;x<u.length;x++)o.default.areConnected(this.rooms[h],u[x])||n()<.2&&this.addDoor(this.findNewDoorLocation(this.rooms[h],u[x]));this.addStairsDown&&this.addStairs(s.default.stairsDown),this.addStairsUp&&this.addStairs(s.default.stairsUp)}},{key:"getFlattenedTiles",value:function(){for(var o=Array(this.size.y),s=0;s<this.size.y;s++){o[s]=Array(this.size.x);for(var e=0;e<this.size.x;e++)o[s][e]=null}for(var i=0;i<this.rooms.length;i++)for(var t=this.rooms[i],r=0;r<t.size.y;r++)for(var a=0;a<t.size.x;a++)0!==t.tiles[r][a]&&(o[r+t.pos.y][a+t.pos.x]={type:t.tiles[r][a],hasBeenSeen:!1});return o}},{key:"getCollisionMap",value:function(){for(var o=Array(this.size.y),e=0;e<this.size.y;e++){o[e]=Array(this.size.x);for(var i=0;i<this.size.x;i++)o[e][i]=0}for(var t=0;t<this.rooms.length;t++)for(var r=this.rooms[t],a=0;a<r.size.y;a++)for(var n=0;n<r.size.x;n++){var y=0;switch(r.tiles[a][n]){case s.default.wall:y=1;break;case s.default.stairsUp:y=2;break;case s.default.stairsDown:y=3}o[a+r.pos.y][n+r.pos.x]=y}return o}},{key:"roomIntersect",value:function(o,s){var e=o.pos.x,i=o.pos.y,t=o.size.x,r=o.size.y,a=s.pos.x,n=s.pos.y,y=s.size.x,h=s.size.y;return!(e+t<=a+1||e>=a+y-1||i+r<=n+1||i>=n+h-1)}},{key:"canFitRoom",value:function(o){if(o.pos.x<0||o.pos.x+o.size.x>this.size.x-1)return!1;if(o.pos.y<0||o.pos.y+o.size.y>this.size.y-1)return!1;for(var s=0;s<this.rooms.length;s++){var e=this.rooms[s];if(this.roomIntersect(o,e))return!1}return!0}},{key:"getPotentiallyTouchingRooms",value:function(o){for(var s=[],e=function(e,i,t){for(var r=t[i][e],a=0;a<r.length;a++)if(r[a]!==o&&s.indexOf(r[a])<0){var n=e-r[a].pos.x,y=i-r[a].pos.y;(n>0&&n<r[a].size.x-1||y>0&&y<r[a].size.y-1)&&s.push(r[a])}},i=o.pos.x+1;i<o.pos.x+o.size.x-1;i++)e(i,o.pos.y,this.roomGrid),e(i,o.pos.y+o.size.y-1,this.roomGrid);for(var t=o.pos.y+1;t<o.pos.y+o.size.y-1;t++)e(o.pos.x,t,this.roomGrid),e(o.pos.x+o.size.x-1,t,this.roomGrid);return s}},{key:"findNewDoorLocation",value:function(o,s){var e={x:-1,y:-1},i=-1;switch(o.pos.y===s.pos.y-o.size.y+1?i=0:o.pos.x===s.pos.x-o.size.x+1?i=1:o.pos.x===s.pos.x+s.size.x-1?i=2:o.pos.y===s.pos.y+s.size.y-1&&(i=3),i){case 0:e.x=u(a(h(s.pos.x,o.pos.x)+1),a(y(s.pos.x+s.size.x,o.pos.x+o.size.x)-1)),e.y=s.pos.y;break;case 1:e.x=s.pos.x,e.y=u(a(h(s.pos.y,o.pos.y)+1),a(y(s.pos.y+s.size.y,o.pos.y+o.size.y)-1));break;case 2:e.x=o.pos.x,e.y=u(a(h(s.pos.y,o.pos.y)+1),a(y(s.pos.y+s.size.y,o.pos.y+o.size.y)-1));break;case 3:e.x=u(a(h(s.pos.x,o.pos.x)+1),a(y(s.pos.x+s.size.x,o.pos.x+o.size.x)-1)),e.y=o.pos.y}return e}},{key:"findRoomAttachment",value:function(o){var s=x(this.rooms),e={x:0,y:0};switch(u(0,4)){case 0:e.x=u(s.pos.x-o.size.x+3,s.pos.x+s.size.x-2),e.y=s.pos.y-o.size.y+1;break;case 1:e.x=s.pos.x-o.size.x+1,e.y=u(s.pos.y-o.size.y+3,s.pos.y+s.size.y-2);break;case 2:e.x=s.pos.x+s.size.x-1,e.y=u(s.pos.y-o.size.y+3,s.pos.y+s.size.y-2);break;case 3:e.x=u(s.pos.x-o.size.x+3,s.pos.x+s.size.x-2),e.y=s.pos.y+s.size.y-1}return{position:e,target:s}}},{key:"addRoom",value:function(o){if(!this.canFitRoom(o))return!1;this.rooms.push(o);for(var s=o.pos.y;s<o.pos.y+o.size.y;s++)for(var e=o.pos.x;e<o.pos.x+o.size.x;e++){var i=this.roomGrid[s][e];i.push(o),this.roomGrid[s][e]=i}return!0}},{key:"addDoor",value:function(o){for(var e=this.roomGrid[o.y][o.x],i=0;i<e.length;i++){var t=e[i],r=o.x-t.pos.x,a=o.y-t.pos.y;t.tiles[a][r]=s.default.door}}},{key:"createRandomRoom",value:function(){var s=0,e=0,i=0;do{i=(s=u(this.minRoomSize,this.maxRoomSize))*(e=u(this.minRoomSize,this.maxRoomSize))}while(this.maxRoomArea>0&&i>this.maxRoomArea);return new o.default(s,e)}},{key:"generateRoom",value:function(){for(var o=this.createRandomRoom(),s=150;s-- >0;){var e=this.findRoomAttachment(o);if(o.pos=e.position,this.addRoom(o)){this.addDoor(this.findNewDoorLocation(o,e.target));break}}}},{key:"addStairs",value:function(o){var e=null;do{e=x(this.rooms)}while(e.getDoorLocations().length>1||e.hasStairs());for(var i=[],t=1;t<e.size.y-2;t++)for(var r=1;r<e.size.x-2;r++)e.tiles[t][r]===s.default.floor&&e.tiles[t-1][r]!==s.default.door&&e.tiles[t+1][r]!==s.default.door&&e.tiles[t][r-1]!==s.default.door&&e.tiles[t][r+1]!==s.default.door&&i.push({x:r,y:t});var a=x(i);e.tiles[a.y][a.x]=o}}]),e}();exports.default=p;
},{"./room":"U5Xy","./tiles":"BL8S"}],"BSXI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={left:37,up:38,right:39,down:40};exports.default=e;
},{}],"hZZ8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=s(require("./dungeon")),i=s(require("./keys")),t=s(require("./tiles"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function a(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function l(e,i,t){return i&&a(e.prototype,i),t&&a(e,t),e}var n=Math.floor,o=Math.abs,y=16,u=function(){function s(){r(this,s),this.dungeon=new e.default(100,100),this.dungeon.generate(),this.collisionMap=this.dungeon.getCollisionMap(),this.tiles=this.dungeon.getFlattenedTiles(),this.player={pos:{x:0,y:0},size:{x:12,y:12},speed:175,color:"#0CED13",onStairs:!0};var i=this.dungeon.getStairs();this.player.pos.x=i.up.x*y+y/2-this.player.size.x/2,this.player.pos.y=i.up.y*y+y/2-this.player.size.y/2}return l(s,[{key:"width",value:function(){return this.dungeon.size.x*y}},{key:"height",value:function(){return this.dungeon.size.y*y}},{key:"update",value:function(e,s){var r={x:0,y:0};i.default.left in s&&(r.x-=this.player.speed*e),i.default.right in s&&(r.x+=this.player.speed*e),i.default.up in s&&(r.y-=this.player.speed*e),i.default.down in s&&(r.y+=this.player.speed*e),this.player.pos=this.moveEntity(this.player.pos,this.player.size,r);for(var a=n((this.player.pos.x+this.player.size.x/2)/y),l=n((this.player.pos.y+this.player.size.y/2)/y),o=0,u=!1,f=this.dungeon.roomGrid[l][a],h=0;h<f.length;h++){var p=f[h],d=a-p.pos.x,x=l-p.pos.y;if(p.tiles[x][d]===t.default.stairsUp&&(u=!0,!this.player.onStairs)){o=-1;break}if(p.tiles[x][d]===t.default.stairsDown&&(u=!0,!this.player.onStairs)){o=1;break}}return this.player.onStairs=u,o}},{key:"isTileVisible",value:function(e,i,t,s,r){if("none"===e)return!0;if("room"===e){var a=this.dungeon.roomGrid[t][i];if(null!==a)for(var l=0;l<a.length;l++){var n=a[l];if(s>=n.pos.x&&s<n.pos.x+n.size.x&&r>=n.pos.y&&r<n.pos.y+n.size.y)return!0}}if("los"===e){if(i<0||i>=this.dungeon.size.x||s<0||s>=this.dungeon.size.x||t<0||t>=this.dungeon.size.y||r<0||r>=this.dungeon.size.y)return!0;for(var y=o(s-i),u=o(r-t),f=i<s?1:-1,h=t<r?1:-1,p=y-u;i!==s||t!==r;){if(1===this.collisionMap[t][i])return!1;var d=2*p;d>-u&&(p-=u,i+=f),d<y&&(p+=y,t+=h)}return!0}return!1}},{key:"draw",value:function(e,i,s,r){for(var a=n((this.player.pos.x+this.player.size.x/2)/y),l=n((this.player.pos.y+this.player.size.y/2)/y),o=n(s.x/y)-1,u=n(s.y/y)-1,f=(s.x%y+y)%y,h=(s.y%y+y)%y,p=-f-y,d=-h-y,x=e.width+y-f,c=e.height+y-h,v=u,g=d;g<c;v++,g+=y)if(!(v<0||v>=this.dungeon.size.y))for(var z=o,b=p;b<x;z++,b+=y)if(!(z<0||z>=this.dungeon.size.x)){var k=this.tiles[v][z];if(null!==k){var w=this.isTileVisible(r,a,l,z,v);if(w&&(k.HasBeenSeen=!0),k.HasBeenSeen){switch(k.type){case t.default.floor:case t.default.door:i.fillStyle=w?"#B8860B":"#705104";break;case t.default.wall:i.fillStyle=w?"#8B4513":"#61300D";break;case t.default.stairsDown:i.fillStyle="#7A5A0D";break;case t.default.stairsUp:i.fillStyle="#F2CD27"}i.fillRect(b,g,y,y)}}}i.fillStyle=this.player.color,i.fillRect(n(this.player.pos.x-s.x),n(this.player.pos.y-s.y),n(this.player.size.x),n(this.player.size.y))}},{key:"moveEntity",value:function(e,i,s){var r={x:e.x+s.x,y:e.y+s.y};if(s.x){var a=s.x>0?i.x:0,l=n((e.x+s.x+a)/y),o=n(e.y/y),u=Math.ceil((e.y+i.y)/y);if(u>=0&&o<this.dungeon.size.y&&l>=0&&l<this.dungeon.size.x)for(var f=o;f<u;f++)if(this.collisionMap[f][l]===t.default.wall){r.x=l*y-a+(s.x<0?y:0);break}}if(s.y){var h=s.y>0?i.y:0,p=n((e.y+s.y+h)/y),d=n(r.x/y),x=Math.ceil((r.x+i.x)/y);if(x>=0&&d<this.dungeon.size.x&&p>=0&&p<this.dungeon.size.y)for(var c=d;c<x;c++)if(this.collisionMap[p][c]===t.default.wall){r.y=p*y-h+(s.y<0?y:0);break}}return r}}]),s}();exports.default=u;
},{"./dungeon":"F6Jf","./keys":"BSXI","./tiles":"BL8S"}],"epB2":[function(require,module,exports) {
"use strict";var e=n(require("./level")),t=n(require("./keys"));function n(e){return e&&e.__esModule?e:{default:e}}var d=Math.floor,a={};window.addEventListener("keydown",function(e){for(var n in t.default)if(t.default[n]===e.keyCode)return a[e.keyCode]=!0,e.preventDefault&&e.preventDefault(),!0},!1),window.addEventListener("keyup",function(e){for(var n in t.default)if(t.default[n]===e.keyCode)return delete a[e.keyCode],e.preventDefault&&e.preventDefault(),!0},!1);var i=[new e.default],o=0,r="room",u=!1;document.getElementById("resetBtn").addEventListener("click",function(){i=[new e.default],o=0}),document.getElementById("screenshotBtn").addEventListener("click",function(){u=!0});var l,f=document.getElementById("visibility");function s(t){window.requestAnimationFrame(s),l||(l=t);var n=(t-l)/1e3;l=t;var f=i[o].update(n,a);-1===f?o>0&&o--:1===f&&(o===i.length-1&&i.push(new e.default),o++);var c=document.getElementById("myCanvas"),v=i[o].player,y=v.pos.x+v.size.x/2,m=v.pos.y+v.size.y/2,w={x:d(y-c.width/2),y:d(m-c.height/2)},p=c.getContext("2d");p.fillStyle="black",p.fillRect(0,0,c.width,c.height),i[o].draw(c,p,w,r),u&&(window.open(document.getElementById("myCanvas").toDataURL("image/png")),u=!1)}f.onchange=function(){r=f.options[f.selectedIndex].value},window.requestAnimationFrame(s);
},{"./level":"hZZ8","./keys":"BSXI"}]},{},["epB2"], null)